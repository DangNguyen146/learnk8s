<match geoip_vnw_access.**>
    @type copy
    <store>
        @type file
        format json
        path /data/td-agent/logs/prod/access/vnw_access
        time_slice_format %Y%m%d
        time_slice_wait 10m
        time_format %Y-%m-%d %H:%M:%S
        #include_time_key true
        compress gzip
        buffer_type file
        buffer_chunk_limit 1024m
        buffer_queue_limit 10240
        buffer_path /data/td-agent/logs/prod/buffer/buffer_vnw_access
        disable_retry_limit false
        retry_limit 17
    </store>
    <store>
        @type elasticsearch
        host 172.16.5.47
        user td-agent
        password aJtK29az9mzTSMi
        port 9200
        logstash_format true
        type_name vnw_access
        logstash_prefix vnw_access
        verify_es_version_at_startup false
        default_elasticsearch_version 5
        #buffer_type memory
        time_key_format "%Y-%m-%d %H:%M:%S"
        buffer_type file
        buffer_chunk_limit 1024m
        buffer_queue_limit 10240
        buffer_path /data/td-agent/logs/prod/buffer/buffer_elasticsearch_vnw_access
        flush_mode interval
        flush_interval 1s
        retry_limit 17
        num_threads 1
        request_timeout 20s
        <secondary>
            @type secondary_file
            directory /data/td-agent/errors
            basename geoip_vnw_access.logs
        </secondary>
    </store>
</match>
<match geoip_vnw_api_access.**>
    @type copy
    <store>
        @type file
        format json
        path /data/td-agent/logs/prod/access/vnw_api_access
        time_slice_format %Y%m%d
        time_slice_wait 10m
        time_format %Y-%m-%d %H:%M:%S
        include_time_key true
        compress gzip
        buffer_type file
        buffer_chunk_limit 1024m
        buffer_queue_limit 10240
        buffer_path /data/td-agent/logs/prod/buffer/buffer_vnw_api_access
        disable_retry_limit false
        retry_limit 17
    </store>
    <store>
        @type elasticsearch
        host 172.16.5.45
        # user td-agent
        # password aJtK29az9mzTSMi
        port 9200
        logstash_format true
        type_name vnw_access
        logstash_prefix vnw_api_access
        verify_es_version_at_startup false
        default_elasticsearch_version 5
        #buffer_type memory
        buffer_type file
        buffer_chunk_limit 1024m
        buffer_queue_limit 10240
        buffer_path /data/td-agent/logs/prod/buffer/buffer_elasticsearch_vnw_api_access
        flush_mode interval
        flush_interval 1s
        retry_limit 17
        retry_wait 1.0
        num_threads 1
        request_timeout 45s
        <secondary>
            @type secondary_file
            directory /data/td-agent/errors
            basename geoip_vnw_api_access.logs
        </secondary>
    </store>
</match>

